#!/bin/sh

OLD_DIR=/media/internal/.app-storage/file_.media.cryptofs.apps.usr.palm.applications.org.webosinternals.navit_0
NAVIT_USER_DATADIR=/media/internal/appdata/org.webosinternals.navit

mkdir -p $NAVIT_USER_DATADIR

# Migrate data from old to new directories
if [ -d $OLD_DIR ]
then
	mv $OLD_DIR/* $NAVIT_USER_DATADIR
	rmdir $OLD_DIR
	# Replace espeak with speech-dispatcher in navit.xml
	sed -i -re "/org.webosinternals.espeak/ s/<speech type=\"cmdline\".*\/>/<speech type=\"speech_dispatcher\" data=\"100\" cps=\"15\" \/>/" $NAVIT_USER_DATADIR/navit.xml
fi
if [ -d /media/internal/MapsNavit ]
then
	mv /media/internal/MapsNavit $NAVIT_USER_DATADIR/maps
	sed -i -re "s/\/media\/internal\/MapsNavit/\$NAVIT_USER_DATADIR\/maps/" $NAVIT_USER_DATADIR/navit.xml
	rmdir /media/internal/.app-storage/file_.media.cryptofs.apps.usr.palm.applications.org.webosinternals.navit_0
fi

